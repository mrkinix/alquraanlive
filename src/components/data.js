export const surah = [
    1,   // Surah 1: Al-Fatiha (ends on page 1)
    49,  // Surah 2: Al-Baqarah (ends on page 49)
    76,  // Surah 3: Al-Imran (ends on page 76)
    105, // Surah 4: An-Nisa (ends on page 105)
    127, // Surah 5: Al-Ma'idah (ends on page 127)
    150, // Surah 6: Al-An'am (ends on page 150)
    176, // Surah 7: Al-A'raf (ends on page 176)
    186, // Surah 8: Al-Anfal (ends on page 186)
    207, // Surah 9: At-Tawbah (ends on page 207)
    220, // Surah 10: Yunus (ends on page 220)
    234, // Surah 11: Hud (ends on page 234)
    248, // Surah 12: Yusuf (ends on page 248)
    254, // Surah 13: Ar-Ra'd (ends on page 254)
    261, // Surah 14: Ibrahim (ends on page 261)
    266, // Surah 15: Al-Hijr (ends on page 266)
    281, // Surah 16: An-Nahl (ends on page 281)
    292, // Surah 17: Al-Isra (ends on page 292)
    304, // Surah 18: Al-Kahf (ends on page 304)
    311, // Surah 19: Maryam (ends on page 311)
    321, // Surah 20: Taha (ends on page 321)
    330, // Surah 21: Al-Anbiya (ends on page 330)
    341, // Surah 22: Al-Hajj (ends on page 341)
    349, // Surah 23: Al-Mu'minun (ends on page 349)
    358, // Surah 24: An-Nur (ends on page 358)
    366, // Surah 25: Al-Furqan (ends on page 366)
    376, // Surah 26: Ash-Shu'ara (ends on page 376)
    384, // Surah 27: An-Naml (ends on page 384)
    395, // Surah 28: Al-Qasas (ends on page 395)
    403, // Surah 29: Al-Ankabut (ends on page 403)
    410, // Surah 30: Ar-Rum (ends on page 410)
    414, // Surah 31: Luqman (ends on page 414)
    417, // Surah 32: As-Sajdah (ends on page 417)
    427, // Surah 33: Al-Ahzab (ends on page 427)
    433, // Surah 34: Saba (ends on page 433)
    439, // Surah 35: Fatir (ends on page 439)
    445, // Surah 36: Ya-Sin (ends on page 445)
    452, // Surah 37: As-Saffat (ends on page 452)
    457, // Surah 38: Sad (ends on page 457)
    466, // Surah 39: Az-Zumar (ends on page 466)
    476, // Surah 40: Ghafir (ends on page 476)
    482, // Surah 41: Fussilat (ends on page 482)
    488, // Surah 42: Ash-Shura (ends on page 488)
    495, // Surah 43: Az-Zukhruf (ends on page 495)
    498, // Surah 44: Ad-Dukhan (ends on page 498)
    501, // Surah 45: Al-Jathiyah (ends on page 501)
    506, // Surah 46: Al-Ahqaf (ends on page 506)
    510, // Surah 47: Muhammad (ends on page 510)
    514, // Surah 48: Al-Fath (ends on page 514)
    517, // Surah 49: Al-Hujurat (ends on page 517)
    519, // Surah 50: Qaf (ends on page 519)
    522, // Surah 51: Adh-Dhariyat (ends on page 522)
    525, // Surah 52: At-Tur (ends on page 525)
    527, // Surah 53: An-Najm (ends on page 527)
    530, // Surah 54: Al-Qamar (ends on page 530)
    533, // Surah 55: Ar-Rahman (ends on page 533)
    536, // Surah 56: Al-Waqi'ah (ends on page 536)
    541, // Surah 57: Al-Hadid (ends on page 541)
    544, // Surah 58: Al-Mujadilah (ends on page 544)
    548, // Surah 59: Al-Hashr (ends on page 548)
    550, // Surah 60: Al-Mumtahanah (ends on page 550)
    552, // Surah 61: As-Saff (ends on page 552)
    553, // Surah 62: Al-Jumu'ah (ends on page 553)
    555, // Surah 63: Al-Munafiqun (ends on page 555)
    557, // Surah 64: At-Taghabun (ends on page 557)
    559, // Surah 65: At-Talaq (ends on page 559)
    561, // Surah 66: At-Tahrim (ends on page 561)
    563, // Surah 67: Al-Mulk (ends on page 563)
    565, // Surah 68: Al-Qalam (ends on page 565)
    567, // Surah 69: Al-Haqqah (ends on page 567)
    569, // Surah 70: Al-Ma'arij (ends on page 569)
    571, // Surah 71: Nuh (ends on page 571)
    573, // Surah 72: Al-Jinn (ends on page 573)
    574, // Surah 73: Al-Muzzammil (ends on page 574)
    576, // Surah 74: Al-Muddaththir (ends on page 576)
    577, // Surah 75: Al-Qiyamah (ends on page 577)
    579, // Surah 76: Al-Insan (ends on page 579)
    581, // Surah 77: Al-Mursalat (ends on page 581)
    582, // Surah 78: An-Naba (ends on page 582)
    584, // Surah 79: An-Nazi'at (ends on page 584)
    585, // Surah 80: Abasa (ends on page 585)
    586, // Surah 81: At-Takwir (ends on page 586)
    587, // Surah 82: Al-Infitar (ends on page 587)
    588, // Surah 83: Al-Mutaffifin (ends on page 588)
    589, // Surah 84: Al-Inshiqaq (ends on page 589)
    590, // Surah 85: Al-Buruj (ends on page 590)
    591, // Surah 86: At-Tariq (ends on page 591)
    591, // Surah 87: Al-A'la (ends on page 591)
    592, // Surah 88: Al-Ghashiyah (ends on page 592)
    594, // Surah 89: Al-Fajr (ends on page 594)
    594, // Surah 90: Al-Balad (ends on page 594)
    595, // Surah 91: Ash-Shams (ends on page 595)
    596, // Surah 92: Al-Layl (ends on page 596)
    596, // Surah 93: Ad-Duha (ends on page 596)
    597, // Surah 94: Ash-Sharh (ends on page 597)
    597, // Surah 95: At-Tin (ends on page 597)
    598, // Surah 96: Al-Alaq (ends on page 598)
    598, // Surah 97: Al-Qadr (ends on page 598)
    599, // Surah 98: Al-Bayyinah (ends on page 599)
    599, // Surah 99: Az-Zalzalah (ends on page 599)
    600, // Surah 100: Al-Adiyat (ends on page 600)
    600, // Surah 101: Al-Qari'ah (ends on page 600)
    601, // Surah 102: At-Takathur (ends on page 601)
    601, // Surah 103: Al-Asr (ends on page 601)
    601, // Surah 104: Al-Humazah (ends on page 601)
    602, // Surah 105: Al-Fil (ends on page 602)
    602, // Surah 106: Quraish (ends on page 602)
    602, // Surah 107: Al-Ma'un (ends on page 602)
    603, // Surah 108: Al-Kawthar (ends on page 603)
    603, // Surah 109: Al-Kafirun (ends on page 603)
    603, // Surah 110: An-Nasr (ends on page 603)
    604, // Surah 111: Al-Masad (ends on page 604)
    604, // Surah 112: Al-Ikhlas (ends on page 604)
    604, // Surah 113: Al-Falaq (ends on page 604)
    604  // Surah 114: An-Nas (ends on page 604)
]



async function handleCapture(canvas) {
  loading.value = true;
  text.value = '';
  matches.value = []; // Ensure matches is defined in your state

  try {
    // Convert canvas to data URL for Tesseract
    const imageDataUrl = canvas.toDataURL('image/jpeg', 0.9);

    // Run Tesseract.js with the same configuration as handleFile
    const { data: { text: result } } = await Tesseract.recognize(imageDataUrl, 'eng', {
      tessedit_char_whitelist: '٠١٢٣٤٥٦٧٨٩0123456789',
      tessedit_do_invert: true,
      preserve_interword_spaces: 1,
      logger: m => console.log(m),
    });

    text.value = result;
    alert(result, 5); // Ensure findClosestVerses and quranData are defined

    // Extract numbers (Arabic-Indic or Western) as in handleFile
    const arabicNumbers = result.match(/[٠١٢٣٤٥٦٧٨٩]+/g)?.join('') || '';
    const westernNumbers = result.match(/[0-9]+/g)?.join('') || '';

    // Convert Arabic-Indic to Western numbers
    const numberMap = {
      '٠': '0', '١': '1', '٢': '2', '٣': '3', '٤': '4',
      '٥': '5', '٦': '6', '٧': '7', '٨': '8', '٩': '9'
    };
    const detectedNumber = arabicNumbers
      ? arabicNumbers.replace(/[٠١٢٣٤٥٦٧٨٩]/g, d => numberMap[d])
      : westernNumbers;

    if (detectedNumber) {
      const verseId = parseInt(detectedNumber.slice(0, 3)) % 286 || 1;
      await fetchVerse(2, verseId);
    } else {
      alert('No numbers detected. Please try again with clearer text.');
    }
  } catch (err) {
    console.error('Tesseract OCR error:', err);
    text.value = '❌ Error: ' + err.message;
  } finally {
    loading.value = false;
  }
}
